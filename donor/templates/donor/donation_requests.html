{% extends 'base.html' %}
{% block content %}
<h2 style="text-align:center; color: var(--dark-green); margin-bottom: 2rem;">Donation Requests</h2>

{% if requests %}
<div style="overflow-x:auto; max-width: 1000px; margin: 0 auto;">
<table class="table" style="width:100%; border-collapse: collapse; background-color:#fdf6e3; box-shadow:0 3px 6px rgba(0,0,0,0.1); border-radius:8px;">
    <thead style="background-color: var(--dark-green); color: white;">
        <tr style="text-align: center;">
            <th style="padding:0.75rem; text-align:center; vertical-align:middle;">Donation</th>
            <th style="padding:0.75rem; text-align:center; vertical-align:middle;">NGO</th>
            <th style="padding:0.75rem; text-align:center; vertical-align:middle;">Status</th>
            <th style="padding:0.75rem; text-align:center; vertical-align:middle;">Requested At</th>
            <th style="padding:0.75rem; text-align:center; vertical-align:middle;">Action</th>
        </tr>
    </thead>
    <tbody>
        {% for req in requests %}
        <tr style="text-align:center; border-bottom:1px solid #ddd;">
            <td style="padding:0.75rem;">{{ req.donation.title }}</td>
            <td style="padding:0.75rem;">
                {% if req.receiver %}
                    {{ req.receiver.name }} ({{ req.receiver.user.username }})
                {% else %}
                    <span style="color:red;">No NGO linked</span>
                {% endif %}
            </td>
            <td style="padding:0.75rem;">
                {% if req.status == 'pending' %}
                    <span style="color:orange; font-weight:bold;">Pending</span>
                {% elif req.status == 'accepted' %}
                    <span style="color:green; font-weight:bold;">Accepted</span>
                {% elif req.status == 'rejected' %}
                    <span style="color:red; font-weight:bold;">Rejected</span>
                {% else %}
                    {{ req.get_status_display }}
                {% endif %}
            </td>
            
            <td style="padding:0.75rem;">{{ req.date_requested|date:"Y-m-d H:i" }}</td>
            <td style="padding:0.75rem;">
                {% if req.status == 'pending' %}
                <form method="POST" style="display:inline;">
                    {% csrf_token %}
                    <input type="hidden" name="request_id" value="{{ req.id }}">
                    <button type="submit" name="action" value="accept" class="btn btn-success">Accept</button>
                    <button type="submit" name="action" value="reject" class="btn btn-danger">Reject</button>
                </form>
                {% else %}
                    <em>{{ req.get_status_display }}</em>
                {% endif %}
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>
</div>
{% else %}
<p style="text-align:center; margin-top:2rem;">No requests yet.</p>
{% endif %}
{% endblock %}





